1. Создание бэкапа
<В LiveUSB переключаемся на root>
$ sudo su

<Монтируем раздел, который будем архивировать>
# mount -o ro /dev/нужный_раздел /mnt

<Примонтируем носитель для чтения-записи, чтобы писать туда бэкап>
# mount -o rw /dev/флешка /lib/live/mount/medium

<Создаем архив>
tar -cvzpf /lib/live/mount/medium/backupYYYYMMDD.tgz --exclude=/mnt/var/cache /mnt/

<Отмонтируем диск>
# umount /mnt

<Перезагружаемся>
# reboot

2. Восстановление бэкапа
<Грузимся с LiveUSB и переключаемся в root>
...

<Делаем разметку диска>
# cfdisk <проверим там типы разделов, который под систему должен быть 83Linux, если
требуется помечаем системный раздел загрузочным и сохраняем изменения>

<Создаем файловую систему на системном разделе>
# mkfs.ext4 /dev/корень

3. Распаковываем архив
<Монтируем отформатированный раздел>
# mount /dev/корень /mnt

<Распаковывам архив с бэкапом с носителя>
# tar --same-owner -xvpf /lib/live/mount/medium/backupYYYYMMDD.tgz -C /mnt/
// параметр --same-owner сохраняет инфу о владельцах у распаковываемых файлов,
p - сохраняет права доступа, f - указывает файл, который распаковываем

<Создаем загрузочную запись>
# mount --bind /dev /mnt/dev
# mount --bind /proc /mnt/proc 
// параметр bind нужен для того, чтобы те каталоги, которые используются в live-режиме
были доступны сразу в двух местах и в liveUSB и в будущей системе

<Переключаемся на новую систему использую chroot>
# chroot /mnt

<Подлючаем если требуется подкачку>
# swapon /dev/подкачка

<Для работы GRUB надо указать ему верные UUID разделов в fstab>
<Сейчас там прописаны разделы пред. системы и поэтому нам вызвать софт для просмотра тек. UUID>
# blkid

<Переписываем в /etc/fstab верные UUID и сохраняем изменения>
...

<Устанавливаем grub2>
# grub-install /dev/наш_диск

<Обновляем инфу из fstab>
# update-grub

<Возвращаемся в Live-систему>
# exit

<Размонтируем все каталоги>
# umount /mnt/dev
# umount /mnt/proc
# umount /mnt

<Перезапуск>
# reboot

ГОТОВО!


